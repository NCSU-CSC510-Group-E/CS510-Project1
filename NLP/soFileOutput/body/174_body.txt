<p>I want to print HTML from a C# web service.  The Web Browser control is overkill, and does not function well in a service environment, nor does it function well on a system with very tight security constraints.  Is there any sort of free <code>.NET</code> library that will support the printing of a basic HTML page?  Here is the code I have so far, which does not run properly.</p>

<pre><code>public void PrintThing(string document)
{
    if (Thread.CurrentThread.GetApartmentState() != ApartmentState.STA)
    {
        Thread thread =
            new Thread((ThreadStart) delegate { PrintDocument(document); });
        thread.SetApartmentState(ApartmentState.STA);
        thread.Start();
    }
    else
    {
        PrintDocument(document);
    }
}

protected void PrintDocument(string document)
{
    WebBrowser browser = new WebBrowser();
    browser.DocumentText = document;
    while (browser.ReadyState != WebBrowserReadyState.Complete)
    {
        Application.DoEvents();
    }
    browser.Print();
}
</code></pre>

<p>This works fine when called from UI-type threads, but nothing happens when called from a service-type thread.  Changing <code>Print()</code> to <code>ShowPrintPreviewDialog()</code> yields the following IE script error:</p>

<blockquote>
  <p>Error: 'dialogArguments.___IE_PrintType' is null or not an object<br />
  URL: res://ieframe.dll/preview.dlg</p>
</blockquote>

<p>And a small empty print preview dialog appears.</p>
